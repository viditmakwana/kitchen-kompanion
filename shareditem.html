<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Stylesheets -->
    <!-- If we want to use the Bulma CSS framework -->  
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"> -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Playfair Display" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Comfortaa" />
    <link rel="stylesheet" type="text/css" href="fonts.css" />
    <title>Kitchen Kompanion</title>
</head>
<body>
    <header>
        <div style="text-align: center;"> <h1> Kitchen Kompanion </h1> </div>
    </header>

    <main>
        <div style="border-style: solid; overflow-y: auto; width: 25%; height: 45em; margin: 0 auto; margin-top: 10px; border-radius: 25px;">
            <div style="text-align: center; padding: 2% 0;">
                <h1>Shared Items</h1>
                <div class="searchclass">
                    <input id="searchbar" onkeyup="searchKeyPress()" type="text" placeholder="Search for a food item..">
                    <input type="button" id="btnSearch" Value="Search" onclick="doSomething()" />
                </div>

                <button onClick="changeUser()">change user</button>
                <button onClick="resetTable()">show all</button>

                <head>
                    <!--could have if statement to switch between users?-->
                    <ol id='foodList' class="foodList">
                        <li class="food">Banana</li>
                        <li class="food">Orange</li>
                        <li class="food">Pineapple</li>
                        <li class="food">Tangerine</li>
                        <li class="food">Papaya</li>
                        <li class="food">Apple</li>
                    </ol>
                    <script>
                        var curr_user = "Sally";

                        function changeUser() {
                            if (curr_user == "Sally") {
                                curr_user = "Andrew";
                            } else if (curr_user == "Andrew") {
                                curr_user = "Margot";
                            } else {
                                curr_user = "Sally";
                            }

                            var elem = document.getElementById("currUserHeader");
                            elem.innerHTML = "Log a new purchase as " + curr_user;
                        }

                        function currUser() {
                            document.getElementById("currUser").innerHTML = curr_user;
                            return curr_user;
                        }

                        function getCurrUser() {
                            return curr_user;
                        }

                        function searchKeyPress(e)
                        {
                            let input = document.getElementById('searchbar').value
                            input=input.toLowerCase();
                            let x = document.getElementsByClassName('food');
                            
                            for (i = 0; i < x.length; i++) { 
                                if (!x[i].innerHTML.toLowerCase().includes(input)) {
                                    x[i].style.display="none";
                                }
                                else {
                                    x[i].style.display="list-item";                 
                                }
                            }
                            
                            // look for window.event in case event isn't passed in
                            e = e || window.event;
                            if (e.keyCode == 13)
                            {
                                document.getElementById('btnSearch').click();
                                return false;
                            }
                            return true;
                        }

                        function resetTable() {
                            table = document.getElementById("table");
                            tr = table.getElementsByTagName("tr");

                            for (i = 1; i < tr.length; i++) {
                                tr[i].style.display = "";
                                
                            }
                        }

                        function doSomething() {
                            document.getElementById("test").innerHTML = document.getElementById('searchbar').value;
                            
                            filter = document.getElementById('searchbar').value.toLowerCase();

                            table = document.getElementById("table");
                            tr = table.getElementsByTagName("tr");

                         //   var x = document.getElementById("table").rows[1].cells;
                         //       x[0].innerHTML = "NEW CONTENT";

                            // Loop through all table rows, and hide those who don't match the search query
                            for (i = 1; i < tr.length; i++) {
                                td = table.rows[i].cells[1];
                                
                                
                                if (td) {
                                    txtValue = td.innerHTML.toLowerCase();
                                    document.getElementById("test2").innerHTML = txtValue;
                                    if (txtValue == filter) {
                                        tr[i].style.display = "";
                                    } else {
                                        tr[i].style.display = "none";
                                    }
                                }
                            }
                        }

                    </script>
                  
                <!--<script>var x = document.getElementById("search");</script> NEED SOME WAY TO IDENTIFIY FOOD ITEM-->
                <body onload="currUser()">
                  
                    <h3 id="currUserHeader">Log a new purchase as <span id="currUser"></span></h3>
                    <h3 id="currUserHeader">Log a new purchase as <span id="test"></span></h3>
                    <h3 id="currUserHeader">Log a new purchase as <span id="test2"></span></h3>
                  
                </body>
                  <!--working list-->
                  <script>
                  function addRow(list, inputItem, inputQty, inputPurchDate, inputExpDate) { 
                  /*  var list = document.getElementById(list); */
                    var table = document.getElementById(table);
                 /*   var listItem = document.createElement("li"); */
                   /* listItem.innerText = inputItem.value + " " + inputQty.value + " " + inputPurchDate.value + " " + inputExpDate.value; // passed the field.  */
                   // list.appendChild(listItem);
                    var table = document.getElementById("table");
                
                    var rowCount = table.rows.length;
                    var row = table.insertRow(1);// (rowCount);
                    
                    row.insertCell(0).innerHTML=getCurrUser();
                    row.insertCell(1).innerHTML= inputItem.value;
                    row.insertCell(2).innerHTML= inputQty.value;
                    row.insertCell(3).innerHTML= inputPurchDate.value;
                    row.insertCell(4).innerHTML= inputExpDate.value;

                    document.getElementById('form').reset()
                    return false; // stop submission
                  }

                </script>


                
<!--'list'-->
                <form id="form" onsubmit="return addRow('table', this.inputItem, this.quantity, this.purchaseDate, this.expirationDate)"> 
                  <input type="text" id="inputItem" placeholder="Item">
                  <input type="text" id="quantity" placeholder="Quantity">
                  <input type="text" id="purchaseDate" placeholder="Purchase Date (MM/DD/YYYY)">
                  <input type="text" id="expirationDate" placeholder="Expiration Date (MM/DD/YYYY)">
                  <input type="submit">
                
                </form>

</script>



                <h3>Purchase History</h3>
                
                <ul id="list">
                
                </ul>

                <table id="table" class="table">
                    <tr>
                      <th>Name</th>
                      <th>Item</th>
                      <th>Quantity</th>
                      <th>Purch. Date</th>
                      <th>Exp. Date</th>
                    </tr>
                  </table>

                 
                </div>
                </body>

            </div>
        </div>
    </main>

    <!-- SEARCH BAR STYLE -->
    <style>

.table {
  border-collapse: collapse; /* Collapse borders */
  width: 100%; /* Full-width */
  border: 1px solid #ddd; /* Add a grey border */
  font-size: 18px; /* Increase font-size */
}

#table th, #table td {
  text-align: left; /* Left-align text */
  padding: 12px; /* Add padding */
}

#table tr {
  /* Add a bottom border to all table rows */
  border-bottom: 1px solid #ddd;
}

    /* Style the search box inside the navigation bar */
    .searchclass input[type=text] {
    float: none;
    padding: 6px;
    border: #0047be;
    margin-top: 8px;
    margin-right: 16px;
    font-size: 17px;
    }

    .foodList{
        /*display:none;  */
    }
    </style>

    
</body>
</html>